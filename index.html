<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIVM Control Center | Lightchain AI</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.11.1/ethers.umd.min.js"></script>
    <style>
        :root { --neon: #00ff80; --bg: #050505; --panel: #0a0a0a; --border: #222; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Inter', monospace; display: flex; height: 100vh; overflow: hidden; }
        
        /* Left Navigation Menu */
        nav.side-menu { width: 240px; border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 25px; gap: 30px; background: var(--panel); }
        .nav-logo { font-weight: 900; letter-spacing: 2px; font-size: 1.1rem; color: var(--neon); margin-bottom: 20px; }
        .nav-logo span { color: white; }
        .menu-items { display: flex; flex-direction: column; gap: 10px; }
        .menu-link { color: #888; text-decoration: none; font-size: 0.8rem; letter-spacing: 1px; padding: 10px; border-radius: 6px; transition: 0.2s; }
        .menu-link:hover, .menu-link.active { color: var(--neon); background: rgba(0, 255, 128, 0.05); }

        /* Top Header Area */
        .main-content { flex: 1; display: flex; flex-direction: column; position: relative; }
        header { height: 70px; display: flex; align-items: center; justify-content: flex-end; padding: 0 30px; border-bottom: 1px solid var(--border); }

        /* Top Right Pills */
        .pills-row { display: flex; align-items: center; gap: 12px; }
        .cluster-pill { display: flex; align-items: center; background: #000; border: 1px solid #333; border-radius: 50px; padding: 6px 18px; font-size: 0.7rem; color: var(--neon); }
        .wallet-pill { background: var(--neon); color: #000; border-radius: 50px; padding: 7px 20px; font-size: 0.75rem; font-weight: 900; cursor: pointer; border: none; }

        iframe { flex: 1; border: none; width: 100%; height: 100%; }
    </style>
</head>
<body>

<nav class="side-menu">
    <div class="nav-logo">LIGHTCHAIN <span>AIVM</span></div>
    <div class="menu-items">
        <a href="#" class="menu-link">DASHBOARD</a>
        <a href="#" class="menu-link">MINT SBT</a>
        <a href="#" class="menu-link active">AIVM GENERATOR</a>
        <a href="#" class="menu-link">NODE STATUS</a>
        <a href="#" class="menu-link">DOCS</a>
    </div>
</nav>

<div class="main-content">
    <header>
        <div class="pills-row">
            <div class="cluster-pill">
                <span style="opacity: 0.5; margin-right: 10px;">AIVM-THETA</span>
                <span id="load-val" style="font-weight: 800; margin-right: 10px; min-width: 60px;">LOAD: 0%</span>
                <span id="status-val" style="font-weight: 800; color: #fff; background: #222; padding: 2px 8px; border-radius: 4px;">IDLE</span>
            </div>
            <button id="wallet-btn" class="wallet-pill" onclick="connectWallet()">CONNECT WALLET</button>
        </div>
    </header>
    <iframe id="app-frame" src="artgenerator-ui.html"></iframe>
</div>

<script>
let account = "";
async function connectWallet() {
    if (!window.ethereum) return;
    const provider = new ethers.BrowserProvider(window.ethereum);
    const accounts = await provider.send("eth_requestAccounts", []);
    account = accounts[0];
    const btn = document.getElementById('wallet-btn');
    btn.innerText = account.slice(0,6).toUpperCase() + "..." + account.slice(-4).toUpperCase();
    btn.onclick = async () => {
        await navigator.clipboard.writeText(account);
        btn.innerText = "COPIED!";
        setTimeout(() => { btn.innerText = account.slice(0,6).toUpperCase() + "..." + account.slice(-4).toUpperCase(); }, 1000);
    };
}

window.addEventListener('message', (e) => {
    if (e.data.type === 'AIVM_METRICS') {
        document.getElementById('load-val').innerText = `LOAD: ${e.data.load}%`;
        const st = document.getElementById('status-val');
        st.innerText = e.data.status.toUpperCase();
        st.style.color = (e.data.status === 'mining') ? '#ffcc00' : (e.data.status === 'error' ? '#ff4444' : '#fff');
    }
});
</script>
</body>
</html>
